tosca_definitions_version: cloudify_dsl_1_3

node_templates:

  mongo_host_nic:
    type: cloudify.azure.nodes.network.NetworkInterfaceCard
    properties:
      name: {concat:[{get_input: resource_prefix},mongohostnic,{get_input: resource_suffix}]}
      location: { get_input: location }
      azure_config: { get_input: azure_configuration }
      retry_after: { get_input: retry_after }
    relationships:
    - type: cloudify.azure.relationships.contained_in_resource_group
      target: resource_group
    - type: cloudify.azure.relationships.nic_connected_to_network_security_group
      target: network_security_group
    - type: cloudify.azure.relationships.connected_to_ip_configuration
      target: mongo_host_nic_ip_cfg

  nodejs_host_nic:
    type: cloudify.azure.nodes.network.NetworkInterfaceCard
    properties:
      name: {concat:[{get_input: resource_prefix},nodejs_host_nic,{get_input: resource_suffix}]}
      location: { get_input: location }
      azure_config: { get_input: azure_configuration }
      retry_after: { get_input: retry_after }
    relationships:
    - type: cloudify.azure.relationships.contained_in_resource_group
      target: resource_group
    - type: cloudify.azure.relationships.nic_connected_to_network_security_group
      target: network_security_group
    - type: cloudify.azure.relationships.connected_to_ip_configuration
      target: nodejs_host_nic_ip_cfg

  haproxy_host_nic:
    type: cloudify.azure.nodes.network.NetworkInterfaceCard
    properties:
      name: {concat:[{get_input: resource_prefix},haproxy_host_nic,{get_input: resource_suffix}]}
      location: { get_input: location }
      azure_config: { get_input: azure_configuration }
      retry_after: { get_input: retry_after }
    relationships:
    - type: cloudify.azure.relationships.contained_in_resource_group
      target: resource_group
    - type: cloudify.azure.relationships.nic_connected_to_network_security_group
      target: network_security_group
    - type: cloudify.azure.relationships.connected_to_ip_configuration
      target: haproxy_host_nic_ip_cfg
